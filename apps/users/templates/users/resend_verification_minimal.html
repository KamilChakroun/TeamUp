{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>Resend Verification - TeamUp</title>
    <link rel="shortcut icon" href="{% static 'core/images/favicon.ico' %}" />
    <link rel="stylesheet" href="{% static 'core/css/libs.min.css' %}" />
    <link rel="stylesheet" href="{% static 'core/css/socialv.css' %}" />
    <link rel="stylesheet" href="{% static 'core/vendor/remixicon/fonts/remixicon.css' %}" />
    <style>
      /* Enable scrolling for content */
      .sign-in-page {
        min-height: 100vh;
        display: flex;
        align-items: center;
      }
      .sign-in-from {
        max-height: calc(100vh - 100px);
        overflow-y: auto;
        padding-right: 15px;
      }
      /* Custom scrollbar */
      .sign-in-from::-webkit-scrollbar {
        width: 6px;
      }
      .sign-in-from::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 10px;
      }
      .sign-in-from::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 10px;
      }
      .sign-in-from::-webkit-scrollbar-thumb:hover {
        background: #555;
      }
      .alert-solid {
        color: #fff;
        border: none;
      }
      .alert-solid .btn-close {
        filter: brightness(0) invert(1);
      }
      .alert-solid i {
        font-size: 18px;
        margin-right: 8px;
      }
    </style>
  </head>
  <body>
    <div class="wrapper">
      <section class="sign-in-page">
        <div class="container">
          <div
            class="row justify-content-center align-items-center height-self-center"
          >
            <div class="col-lg-5 col-md-12 align-self-center">
              <div class="sign-user_card">
                <div class="sign-in-page-data">
                  <div class="sign-in-from w-100 m-auto">
                    <img
                      src="{% static 'core/images/logo-full.png' %}"
                      alt="TeamUp"
                      class="img-fluid mb-4"
                      style="max-width: 200px"
                    />

                    <h3 class="mb-3 text-center">Resend Verification Email</h3>
                    <p class="text-muted text-center mb-4">
                      Enter your email address and we'll send you a new
                      verification link.
                    </p>

                    {% if error_message %}
                        <div class="alert alert-solid alert-danger alert-dismissible fade show mb-3" role="alert">
                            <span><i class="ri-alert-line"></i></span>
                            <span> {{ error_message }}</span>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="alert" aria-label="Close"></button>
                        </div>
                    {% endif %}
                                <span><i class="ri-information-line"></i></span>
                                <span> {{ message|safe }}</span>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="alert" aria-label="Close"></button>
                            </div>
                        {% endif %}
                    {% endfor %}
                    {% endif %}

                    <form
                      method="post"
                      action="{% url 'users:resend_verification' %}"
                      class="mt-4"
                      id="resendVerificationForm"
                      novalidate
                    >
                      {% csrf_token %}

                      <div class="form-group mb-3">
                        <label for="email" class="form-label"
                          >Email Address</label
                        >
                        <input
                          type="email"
                          class="form-control"
                          id="email"
                          name="email"
                          placeholder="Enter your email address"
                          value="{{ request.POST.email|default:'' }}"
                          required
                        />
                        <div class="invalid-feedback">
                          Please enter a valid email address.
                        </div>
                        <small class="form-text text-muted">
                          Enter the email you used to sign up
                        </small>
                      </div>

                      <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-primary">
                          <i class="ri-mail-send-line me-1"></i>
                          Send Verification Email
                        </button>
                      </div>
                    </form>

                    <div class="text-center mt-3">
                      <p class="mb-0">
                        Remember your password?
                        <a href="{% url 'users:login' %}" class="text-primary"
                          >Sign In</a
                        >
                      </p>
                    </div>

                    <div class="alert alert-info mt-4" role="alert">
                      <strong>Note:</strong> Verification links expire after 24
                      hours. Make sure to check your spam folder if you don't
                      see the email.
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>

    <script src="{% static 'core/js/libs.min.js' %}"></script>
    <script src="{% static 'core/js/app.js' %}"></script>
    
    <script>
      // Client-side validation for resend verification form
      document.getElementById('resendVerificationForm').addEventListener('submit', function(e) {
        const emailInput = document.getElementById('email');
        const email = emailInput.value.trim();
        
        // Email validation
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        
        if (!email) {
          e.preventDefault();
          emailInput.classList.add('is-invalid');
          return false;
        }
        
        if (!emailRegex.test(email)) {
          e.preventDefault();
          emailInput.classList.add('is-invalid');
          return false;
        }
        
        emailInput.classList.remove('is-invalid');
        emailInput.classList.add('is-valid');
        // Form will submit normally
      });
      
      // Remove invalid state on input
      document.getElementById('email').addEventListener('input', function() {
        this.classList.remove('is-invalid');
      });
    </script>
  </body>
</html>
